<ui:FluentWindow x:Class="AudienciasApp.Views.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:local="clr-namespace:AudienciasApp.Views"
                 xmlns:vm="clr-namespace:AudienciasApp.ViewModels"
                 mc:Ignorable="d"
                 Title="Gestor de Audiencias Judiciales"
                 Height="680"
                 Width="1100"
                 MinHeight="600"
                 MinWidth="900"
                 WindowStartupLocation="CenterScreen"
                 ExtendsContentIntoTitleBar="True"
                 WindowBackdropType="Mica"
                 WindowCornerPreference="Round">

  <Window.DataContext>
    <vm:MainViewModel/>
  </Window.DataContext>

  <Window.Resources>
    <!-- Converters -->
    <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>

    <!-- Animations -->
    <Storyboard x:Key="FadeIn">
      <DoubleAnimation Storyboard.TargetProperty="Opacity"
                       From="0"
                       To="1"
                       Duration="0:0:0.3"/>
    </Storyboard>

    <!-- Card Style -->
    <Style x:Key="CardStyle"
           TargetType="ui:Card">
      <Setter Property="Margin"
              Value="0,0,0,16"/>
      <Setter Property="Padding"
              Value="20"/>
      <Style.Triggers>
        <EventTrigger RoutedEvent="Loaded">
          <BeginStoryboard Storyboard="{StaticResource FadeIn}"/>
        </EventTrigger>
      </Style.Triggers>
    </Style>
  </Window.Resources>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <!-- Title Bar with Theme Toggle -->
    <ui:TitleBar Grid.Row="0"
                 Title="Gestor de Audiencias Judiciales"
                 Height="46">
      <ui:TitleBar.Header>
        <Grid Width="1150">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>

          <StackPanel Orientation="Horizontal"
                      HorizontalAlignment="Left"
                      VerticalAlignment="Center"
                      Margin="16,0"
                      Grid.Column="0">
            <ui:SymbolIcon Symbol="Gavel24"
                           FontSize="20"
                           Margin="0,0,12,0"/>
            <TextBlock Text="Sistema de Gesti√≥n de Audiencias"
                       FontSize="14"
                       VerticalAlignment="Center"/>
            <!-- Status message moved to header for higher visibility -->
            <TextBlock Text="{Binding StatusMessage}"
                       FontSize="12"
                       Opacity="0.9"
                       Margin="12,0,0,0"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource PrimaryAccentBrush}"/>
          </StackPanel>

          <!-- Botones de tema dentro del header (mover Tray a aqu√≠ para v3.0.5) -->
          <StackPanel Grid.Column="1"
                      Orientation="Horizontal"
                      HorizontalAlignment="Right"
                      VerticalAlignment="Center"
                      Margin="0,0,16,0">
            <ui:Button Icon="{ui:SymbolIcon WeatherSunny24}"
                       ToolTip="Cambiar Tema"
                       Command="{Binding ToggleThemeCommand}"
                       Appearance="Transparent"
                       Width="40"
                       Height="30"
                       Margin="4,0"/>
            <ui:Button Icon="{ui:SymbolIcon Settings24}"
                       ToolTip="Configuraci√≥n"
                       Appearance="Transparent"
                       Width="40"
                       Height="30"
                       Margin="4,0"/>
          </StackPanel>
        </Grid>
      </ui:TitleBar.Header>
    </ui:TitleBar>

    <!-- Main Content -->
    <ScrollViewer Grid.Row="1"
                  VerticalScrollBarVisibility="Auto"
                  HorizontalScrollBarVisibility="Disabled">
      <Grid Margin="24">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="2*"
                            MinWidth="500"/>
          <ColumnDefinition Width="20"/>
          <ColumnDefinition Width="*"
                            MinWidth="350"/>
        </Grid.ColumnDefinitions>

        <!-- Left Column - Form -->
        <StackPanel Grid.Column="0">

          <!-- Header Card -->
          <ui:Card Style="{StaticResource CardStyle}"
                   Background="{DynamicResource ControlFillColorDefaultBrush}">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
              </Grid.ColumnDefinitions>

              <ui:SymbolIcon Symbol="DocumentBulletList24"
                             FontSize="32"
                             Margin="0,0,16,0"
                             VerticalAlignment="Center"/>

              <StackPanel Grid.Column="1">
                <TextBlock Text="Registro de Audiencia Judicial"
                           FontSize="20"
                           FontWeight="SemiBold"/>
                <TextBlock Text="Complete los datos de la audiencia judicial"
                           Opacity="0.7"
                           FontSize="12"
                           Margin="0,4,0,0"/>
              </StackPanel>
            </Grid>
          </ui:Card>

          <!-- AI Tools Card -->
          <ui:Card Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="ü§ñ Herramientas IA"
                         FontSize="16"
                         FontWeight="SemiBold"
                         Margin="0,0,0,16"/>

              <ui:InfoBar IsOpen="True"
                          Severity="Informational"
                          IsClosable="False"
                          Margin="0,0,0,12">
                <ui:InfoBar.Content>
                  <TextBlock Text="Use IA para acelerar el registro de audiencias"
                             TextWrapping="Wrap"
                             FontSize="11"/>
                </ui:InfoBar.Content>
              </ui:InfoBar>

              <ui:Button Content="Autocompletado Inteligente"
                         Command="{Binding OpenAIAssistantCommand}"
                         Icon="{ui:SymbolIcon Sparkle24}"
                         HorizontalAlignment="Stretch"
                         Appearance="Info"
                         Margin="0,0,0,8"
                         ToolTip="Complete el formulario describiendo la audiencia en texto libre"/>

              <ui:Button Content="Importaci√≥n Masiva"
                         Command="{Binding BatchImportCommand}"
                         Icon="{ui:SymbolIcon DocumentMultiple24}"
                         HorizontalAlignment="Stretch"
                         Appearance="Primary"
                         ToolTip="Procese documentos PDF/Word para extraer m√∫ltiples audiencias"/>

              <Separator Margin="0,12,0,12"
                  Opacity="0.3"/>

              <StackPanel>
                <TextBlock Text="Estado del Servicio IA:"
                           FontSize="11"
                           Opacity="0.7"
                           Margin="0,0,0,4"/>
                <StackPanel Orientation="Horizontal">
                  <Ellipse Width="8"
                      Height="8"
                           Fill="{Binding AiServiceStatusColor}"
                           Margin="0,0,6,0"/>
                  <TextBlock Text="{Binding AiServiceStatus}"
                             FontSize="11"/>
                </StackPanel>
              </StackPanel>
            </StackPanel>
          </ui:Card>

          <!-- Form Fields Card -->
          <ui:Card Style="{StaticResource CardStyle}">
            <StackPanel>
              <!-- Radicado del Proceso -->
              <Grid Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0"
                            Margin="0,0,8,0">
                  <TextBlock Text="Radicado del Proceso"
                             FontWeight="Medium"
                             Margin="0,0,0,8"/>
                  <ui:TextBox PlaceholderText="Ej: 2025-00123"
                              Text="{Binding CaseCode, UpdateSourceTrigger=PropertyChanged}"
                              Icon="{ui:SymbolIcon DocumentText24}"/>
                </StackPanel>

                <StackPanel Grid.Column="1"
                            Margin="8,0,0,0">
                  <TextBlock Text="Tipo de Audiencia"
                             FontWeight="Medium"
                             Margin="0,0,0,8"/>
                  <ComboBox
                    SelectedValue="{Binding HearingType, Mode=TwoWay}"
                    SelectedValuePath="Content"
                    Width="Auto">
                    <ComboBoxItem>Alegatos de conclusi√≥n</ComboBoxItem>
                    <ComboBoxItem>Audiencia concentrada</ComboBoxItem>
                    <ComboBoxItem>Audiencia de acusaci√≥n</ComboBoxItem>
                    <ComboBoxItem>Audiencia de conciliaci√≥n</ComboBoxItem>
                    <ComboBoxItem>Audiencia de control de legalidad</ComboBoxItem>
                    <ComboBoxItem>Audiencia de individualizaci√≥n de pena</ComboBoxItem>
                    <ComboBoxItem>Audiencia de imputaci√≥n</ComboBoxItem>
                    <ComboBoxItem>Audiencia de incidente de reparaci√≥n integral</ComboBoxItem>
                    <ComboBoxItem>Audiencia de juicio oral</ComboBoxItem>
                    <ComboBoxItem>Audiencia de medidas de aseguramiento</ComboBoxItem>
                    <ComboBoxItem>Audiencia de nulidad</ComboBoxItem>
                    <ComboBoxItem>Audiencia de preclusi√≥n</ComboBoxItem>
                    <ComboBoxItem>Audiencia de pr√≥rroga</ComboBoxItem>
                    <ComboBoxItem>Audiencia de revisi√≥n de medida</ComboBoxItem>
                    <ComboBoxItem>Audiencia de verificaci√≥n de cumplimiento</ComboBoxItem>
                    <ComboBoxItem>Audiencia preliminar</ComboBoxItem>
                    <ComboBoxItem>Audiencia preparatoria</ComboBoxItem>
                    <ComboBoxItem>Otra (opci√≥n para tipos no listados)</ComboBoxItem>
                  </ComboBox>
                </StackPanel>
              </Grid>

              <!-- Fecha y Hora -->
              <Grid Margin="0,0,0,16">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0"
                            Margin="0,0,8,0">
                  <TextBlock Text="Fecha de la Audiencia"
                             FontWeight="Medium"
                             Margin="0,0,0,8"/>
                  <DatePicker SelectedDate="{Binding HearingDate}"/>
                </StackPanel>

                <StackPanel Grid.Column="1"
                            Margin="8,0,0,0">
                  <TextBlock Text="Hora de la Audiencia"
                             FontWeight="Medium"
                             Margin="0,0,0,8"/>
                  <ui:TextBox PlaceholderText="Ej: 08:30 AM"
                              Text="{Binding HearingTime, UpdateSourceTrigger=PropertyChanged}"
                              Icon="{ui:SymbolIcon Clock24}"/>
                </StackPanel>
              </Grid>

              <!-- Juzgado -->
              <StackPanel Margin="0,0,0,16">
                <TextBlock Text="Juzgado/Tribunal"
                           FontWeight="Medium"
                           Margin="0,0,0,8"/>
                <ui:TextBox PlaceholderText="Nombre del juzgado o tribunal"
                            Text="{Binding Court, UpdateSourceTrigger=PropertyChanged}"
                            Icon="{ui:SymbolIcon Building24}"/>
              </StackPanel>

              <!-- Separator -->
              <Separator Margin="0,8,0,16"
                         Opacity="0.3"/>

              <!-- Estado de Realizaci√≥n -->
              <StackPanel Margin="0,0,0,16">
                <TextBlock Text="¬øSe realiz√≥ la audiencia?"
                           FontWeight="Medium"
                           Margin="0,0,0,12"/>

                <Grid>
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                  </Grid.ColumnDefinitions>

                  <RadioButton Grid.Column="0"
                               Content="S√≠, se realiz√≥"
                               GroupName="Realizada"
                               IsChecked="{Binding IsRealizada}"
                               Margin="0,0,8,0"/>

                  <RadioButton Grid.Column="1"
                               Content="No se realiz√≥"
                               GroupName="Realizada"
                               IsChecked="{Binding IsNoRealizada}"
                               Margin="8,0,0,0"/>
                </Grid>
              </StackPanel>

              <!-- Motivo de No Realizaci√≥n (Condicional) -->
              <ui:Card Visibility="{Binding IsNoRealizada, Converter={StaticResource BoolToVisibilityConverter}}"
                       Background="{DynamicResource ControlFillColorTertiaryBrush}"
                       Padding="16"
                       Margin="0,0,0,16">
                <ui:Card.Effect>
                  <DropShadowEffect BlurRadius="10"
                                    Direction="270"
                                    ShadowDepth="2"
                                    Opacity="0.1"/>
                </ui:Card.Effect>

                <StackPanel>
                  <StackPanel Orientation="Horizontal"
                              Margin="0,0,0,12">
                    <ui:SymbolIcon Symbol="Warning24"
                                   Foreground="OrangeRed"
                                   Margin="0,0,8,0"/>
                    <TextBlock Text="Motivo de no realizaci√≥n"
                               FontWeight="Medium"/>
                  </StackPanel>

                  <ComboBox SelectedValue="{Binding MotivoNoRealizada, Mode=TwoWay}"
                            SelectedValuePath="Content"
                            Width="300">
                    <ComboBoxItem>Juez</ComboBoxItem>
                    <ComboBoxItem>Fiscal√≠a</ComboBoxItem>
                    <ComboBoxItem>Usuario</ComboBoxItem>
                    <ComboBoxItem>Inpec</ComboBoxItem>
                    <ComboBoxItem>V√≠ctima</ComboBoxItem>
                    <ComboBoxItem>ICBF</ComboBoxItem>
                    <ComboBoxItem>Defensor Confianza</ComboBoxItem>
                    <ComboBoxItem>Defensor P√∫blico</ComboBoxItem>
                  </ComboBox>
                </StackPanel>
              </ui:Card>

              <!-- Observaciones -->
              <StackPanel>
                <TextBlock Text="Observaciones"
                           FontWeight="Medium"
                           Margin="0,0,0,8"/>
                <ui:TextBox PlaceholderText="Comentarios adicionales (opcional)"
                            Text="{Binding Observations, UpdateSourceTrigger=PropertyChanged}"
                            MinHeight="80"
                            TextWrapping="Wrap"
                            AcceptsReturn="True"
                            VerticalContentAlignment="Top"
                            Icon="{ui:SymbolIcon Comment24}"/>
              </StackPanel>
            </StackPanel>
          </ui:Card>

          <!-- Action Buttons -->
          <ui:Card Style="{StaticResource CardStyle}">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
              </Grid.ColumnDefinitions>

              <StackPanel Orientation="Horizontal"
                          HorizontalAlignment="Left">
                <ui:Button Content="{Binding IsEditMode, Converter={StaticResource BoolToSaveButtonTextConverter}, FallbackValue='Guardar Registro'}"
                           Command="{Binding SaveCommand}"
                           Icon="{ui:SymbolIcon Save24}"
                           Appearance="Primary"
                           FontSize="14"
                           Padding="16,10"
                           Margin="0,0,8,0"/>

                <ui:Button Content="Limpiar Formulario"
                           Command="{Binding ClearCommand}"
                           Icon="{ui:SymbolIcon Delete24}"
                           Appearance="Secondary"
                           FontSize="14"
                           Padding="16,10"
                           Margin="0,0,8,0"/>

                <ui:Button Content="‚ú® Asistente IA"
                           Command="{Binding OpenAIAssistantCommand}"
                           Icon="{ui:SymbolIcon Sparkle24}"
                           Appearance="Info"
                           FontSize="14"
                           Padding="16,10"
                           Margin="8,0,8,0"
                           ToolTip="Autocompletar formulario usando IA"/>

                <ui:Button Content="Cancelar Edici√≥n"
                           Command="{Binding CancelEditCommand}"
                           Icon="{ui:SymbolIcon Dismiss24}"
                           Visibility="{Binding IsEditMode, Converter={StaticResource BoolToVisibilityConverter}}"
                           Appearance="Caution"
                           FontSize="14"
                           Padding="16,10"/>
              </StackPanel>

              <TextBlock Grid.Column="1"
                         Text="{Binding StatusMessage}"
                         VerticalAlignment="Center"
                         Opacity="0.7"
                         FontSize="12"/>
            </Grid>
          </ui:Card>
        </StackPanel>

        <!-- Right Column - Quick Actions & Stats -->
        <StackPanel Grid.Column="2">

          <!-- Quick Actions Card -->
          <ui:Card Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="Acciones R√°pidas"
                         FontSize="16"
                         FontWeight="SemiBold"
                         Margin="0,0,0,16"/>

              <ui:Button Content="Crear Nuevo Archivo"
                         Command="{Binding CreateCommand}"
                         Icon="{ui:SymbolIcon DocumentAdd24}"
                         HorizontalAlignment="Stretch"
                         Appearance="Info"
                         Margin="0,0,0,8"/>

              <ui:Button Content="Abrir Archivo Existente"
                         Command="{Binding OpenCommand}"
                         Icon="{ui:SymbolIcon FolderOpen24}"
                         HorizontalAlignment="Stretch"
                         Margin="0,0,0,8"/>

              <ui:Button Content="Descargar Archivo"
                         Command="{Binding DownloadCommand}"
                         Icon="{ui:SymbolIcon ArrowDownload24}"
                         HorizontalAlignment="Stretch"
                         Margin="0,0,0,8"/>

              <ui:Button Content="Eliminar Archivo"
                         Command="{Binding DeleteCommand}"
                         Icon="{ui:SymbolIcon Delete24}"
                         HorizontalAlignment="Stretch"
                         Appearance="Danger"/>
            </StackPanel>
          </ui:Card>

          <!-- Statistics Card -->
          <ui:Card Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="Estad√≠sticas del D√≠a"
                         FontSize="16"
                         FontWeight="SemiBold"
                         Margin="0,0,0,16"/>

              <Grid>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Audiencias Realizadas -->
                <ui:CardAction Grid.Row="0"
                               Margin="0,0,0,8"
                               IsChevronVisible="False">
                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto"/>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ui:SymbolIcon Grid.Column="0"
                                   Symbol="CheckmarkCircle24"
                                   Foreground="Green"
                                   Margin="0,0,12,0"/>

                    <TextBlock Grid.Column="1"
                               Text="Realizadas"
                               VerticalAlignment="Center"/>

                    <TextBlock Grid.Column="2"
                               Text="{Binding AudienciasRealizadas}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="Green"/>
                  </Grid>
                </ui:CardAction>

                <!-- Audiencias No Realizadas -->
                <ui:CardAction Grid.Row="1"
                               Margin="0,0,0,8"
                               IsChevronVisible="False">
                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto"/>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ui:SymbolIcon Grid.Column="0"
                                   Symbol="DismissCircle24"
                                   Foreground="OrangeRed"
                                   Margin="0,0,12,0"/>

                    <TextBlock Grid.Column="1"
                               Text="No Realizadas"
                               VerticalAlignment="Center"/>

                    <TextBlock Grid.Column="2"
                               Text="{Binding AudienciasNoRealizadas}"
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="OrangeRed"/>
                  </Grid>
                </ui:CardAction>

                <!-- Total -->
                <ui:CardAction Grid.Row="2"
                               IsChevronVisible="False">
                  <Grid>
                    <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="Auto"/>
                      <ColumnDefinition Width="*"/>
                      <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ui:SymbolIcon Grid.Column="0"
                                   Symbol="Calculator24"
                                   Margin="0,0,12,0"/>

                    <TextBlock Grid.Column="1"
                               Text="Total Registros"
                               VerticalAlignment="Center"/>

                    <TextBlock Grid.Column="2"
                               Text="{Binding TotalAudiencias}"
                               FontSize="20"
                               FontWeight="Bold"/>
                  </Grid>
                </ui:CardAction>
              </Grid>
            </StackPanel>
          </ui:Card>

          <!-- Search and Edit Card (added) -->
          <ui:Card Style="{StaticResource CardStyle}">
            <StackPanel>
              <Grid Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Text="Buscar Registros"
                           FontSize="16"
                           FontWeight="SemiBold"/>

                <ui:Button Grid.Column="1"
                           Content="Actualizar"
                           Command="{Binding RefreshCommand}"
                           Icon="{ui:SymbolIcon ArrowSync24}"
                           Appearance="Secondary"
                           FontSize="12"/>
              </Grid>

              <ui:TextBox PlaceholderText="Buscar por radicado..."
                          Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                          Icon="{ui:SymbolIcon Search24}"
                          Margin="0,0,0,8"/>

              <DataGrid ItemsSource="{Binding FilteredHearings}"
                        SelectedItem="{Binding SelectedHearing}"
                        AutoGenerateColumns="False"
                        CanUserAddRows="False"
                        MaxHeight="200"
                        GridLinesVisibility="Horizontal"
                        HeadersVisibility="Column">
                <DataGrid.Columns>
                  <DataGridTextColumn Header="#"
                                      Binding="{Binding RowNumber}"
                                      Width="30"
                                      IsReadOnly="True"/>
                  <DataGridTextColumn Header="Radicado"
                                      Binding="{Binding CaseCode}"
                                      Width="80"/>
                  <DataGridTextColumn Header="Fecha"
                                      Binding="{Binding Date, StringFormat=dd/MM/yyyy}"
                                      Width="75"/>
                  <DataGridCheckBoxColumn Header="‚úì"
                                          Binding="{Binding WasHeld}"
                                          Width="25"
                                          IsReadOnly="True"/>
                  <DataGridTemplateColumn Header=""
                                          Width="60">
                    <DataGridTemplateColumn.CellTemplate>
                      <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                          <ui:Button Icon="{ui:SymbolIcon Edit16}"
                                     Command="{Binding DataContext.EditCommand,
                                               RelativeSource={RelativeSource AncestorType=Window}}"
                                     CommandParameter="{Binding}"
                                     Appearance="Transparent"
                                     ToolTip="Editar"
                                     Width="28"
                                     Height="28"/>
                        </StackPanel>
                      </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                  </DataGridTemplateColumn>
                </DataGrid.Columns>
              </DataGrid>

              <TextBlock Text="No hay registros"
                         Visibility="{Binding HasNoHearings,
                                    Converter={StaticResource BoolToVisibilityConverter}}"
                         Opacity="0.5"
                         FontSize="12"
                         HorizontalAlignment="Center"
                         Margin="0,8,0,0"/>
            </StackPanel>
          </ui:Card>

          <!-- Recent Files Card -->
          <ui:Card Style="{StaticResource CardStyle}">
            <StackPanel>
              <TextBlock Text="Archivos Recientes"
                         FontSize="16"
                         FontWeight="SemiBold"
                         Margin="0,0,0,16"/>

              <ItemsControl ItemsSource="{Binding RecentFiles}">
                <ItemsControl.ItemTemplate>
                  <DataTemplate>
                    <ui:CardAction Margin="0,0,0,4"
                                   Command="{Binding DataContext.OpenRecentCommand,
                                                               RelativeSource={RelativeSource AncestorType=Window}}"
                                   CommandParameter="{Binding}">
                      <Grid>
                        <Grid.ColumnDefinitions>
                          <ColumnDefinition Width="Auto"/>
                          <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ui:SymbolIcon Symbol="Document24"
                                       Margin="0,0,8,0"/>

                        <StackPanel Grid.Column="1">
                          <TextBlock Text="{Binding FileName}"
                                     FontSize="12"/>
                          <TextBlock Text="{Binding LastModified}"
                                     FontSize="10"
                                     Opacity="0.6"/>
                        </StackPanel>
                      </Grid>
                    </ui:CardAction>
                  </DataTemplate>
                </ItemsControl.ItemTemplate>
              </ItemsControl>

              <TextBlock Text="No hay archivos recientes"
                         Visibility="{Binding HasNoRecentFiles,
                                                Converter={StaticResource BoolToVisibilityConverter}}"
                         Opacity="0.5"
                         FontSize="12"
                         HorizontalAlignment="Center"
                         Margin="0,8,0,0"/>
            </StackPanel>
          </ui:Card>
        </StackPanel>
      </Grid>
    </ScrollViewer>

    <!-- Snackbar for notifications -->
    <ui:SnackbarPresenter x:Name="RootSnackbar"
                          Grid.Row="1"
                          VerticalAlignment="Bottom"
                          HorizontalAlignment="Center"
                          Margin="0,0,0,24"/>
  </Grid>
</ui:FluentWindow>