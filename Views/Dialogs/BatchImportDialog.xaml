<ui:FluentWindow x:Class="AudienciasApp.Views.Dialogs.BatchImportDialog"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 Title="ðŸ“„ ImportaciÃ³n Masiva de Audiencias"
                 Width="900"
                 Height="700"
                 WindowStartupLocation="CenterOwner"
                 WindowBackdropType="Mica">

  <Grid Margin="24">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <!-- Header -->
    <ui:Card Grid.Row="0"
        Margin="0,0,0,16"
        Padding="16">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <ui:SymbolIcon Symbol="DocumentMultiple24"
                       FontSize="32"
                       Margin="0,0,16,0"/>

        <StackPanel Grid.Column="1">
          <TextBlock Text="ImportaciÃ³n Masiva desde Documentos"
                     FontSize="20"
                     FontWeight="SemiBold"/>
          <TextBlock Text="Procese documentos para extraer mÃºltiples audiencias automÃ¡ticamente"
                     Opacity="0.7"
                     FontSize="12"
                     Margin="0,4,0,0"/>
        </StackPanel>

        <StackPanel Grid.Column="2"
                    Orientation="Horizontal">
          <ui:Button x:Name="SelectFileButton"
                     Content="Seleccionar Archivo"
                     Icon="{ui:SymbolIcon FolderOpen24}"
                     Click="SelectFile_Click"
                     Margin="0,0,8,0"/>
          <ui:Button x:Name="ProcessFileButton"
                     Content="Procesar"
                     Icon="{ui:SymbolIcon Sparkle24}"
                     IsEnabled="False"
                     Click="ProcessFile_Click"/>
        </StackPanel>
      </Grid>
    </ui:Card>

    <!-- File Info -->
    <ui:Card Grid.Row="1"
             x:Name="FileInfoCard"
             Visibility="Collapsed"
             Margin="0,0,0,16"
             Padding="12">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto"/>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <ui:SymbolIcon Symbol="Document24"
                       Margin="0,0,12,0"/>

        <StackPanel Grid.Column="1">
          <TextBlock x:Name="FileNameText"
                     FontWeight="Medium"/>
          <TextBlock x:Name="FileSizeText"
                     Opacity="0.7"
                     FontSize="11"/>
        </StackPanel>

        <TextBlock Grid.Column="2"
                   x:Name="StatusText"
                   Foreground="{DynamicResource PrimaryAccentBrush}"/>
      </Grid>
    </ui:Card>

    <!-- Results Grid -->
    <ui:Card Grid.Row="2"
        Padding="16">
      <Grid>
        <Grid.RowDefinitions>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Grid Grid.Row="0"
            Margin="0,0,0,12">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
          </Grid.ColumnDefinitions>

          <StackPanel Orientation="Horizontal">
            <TextBlock Text="Audiencias Detectadas:"
                       VerticalAlignment="Center"
                       FontWeight="Medium"
                       Margin="0,0,8,0"/>
            <TextBlock x:Name="DetectedCountText"
                       Text="0"
                       FontSize="16"
                       FontWeight="Bold"
                       VerticalAlignment="Center"/>
          </StackPanel>

          <StackPanel Grid.Column="1"
                      Orientation="Horizontal">
            <ui:Button Content="Seleccionar Todo"
                       x:Name="SelectAllButton"
                       Click="SelectAll_Click"
                       Appearance="Secondary"
                       FontSize="12"
                       Margin="0,0,8,0"/>
            <ui:Button Content="Deseleccionar Todo"
                       x:Name="DeselectAllButton"
                       Click="DeselectAll_Click"
                       Appearance="Secondary"
                       FontSize="12"/>
          </StackPanel>
        </Grid>

        <!-- Data Grid -->
        <DataGrid Grid.Row="1"
                  x:Name="HearingsDataGrid"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column">
          <DataGrid.Columns>
            <DataGridCheckBoxColumn Header="âœ“"
                                    Binding="{Binding IsSelected}"
                                    Width="40"/>
            <DataGridTextColumn Header="Radicado"
                                Binding="{Binding CaseCode}"
                                Width="120"/>
            <DataGridTextColumn Header="Tipo"
                                Binding="{Binding HearingType}"
                                Width="180"/>
            <DataGridTextColumn Header="Fecha"
                                Binding="{Binding Date, StringFormat=dd/MM/yyyy}"
                                Width="90"/>
            <DataGridTextColumn Header="Hora"
                                Binding="{Binding Time}"
                                Width="60"/>
            <DataGridTextColumn Header="Juzgado"
                                Binding="{Binding Court}"
                                Width="150"/>
            <DataGridCheckBoxColumn Header="Realizada"
                                    Binding="{Binding WasHeld}"
                                    Width="70"
                                    IsReadOnly="True"/>
            <DataGridTextColumn Header="Confianza"
                                Binding="{Binding Confidence, StringFormat={}{0:P0}}"
                                Width="80"/>
            <DataGridTemplateColumn Header="Acciones"
                                    Width="100">
              <DataGridTemplateColumn.CellTemplate>
                <DataTemplate>
                  <StackPanel Orientation="Horizontal">
                    <ui:Button Icon="{ui:SymbolIcon Edit16}"
                               ToolTip="Editar"
                               Appearance="Transparent"
                               Width="30"
                               Height="30"
                               Click="EditRow_Click"
                               Tag="{Binding}"/>
                    <ui:Button Icon="{ui:SymbolIcon Delete16}"
                               ToolTip="Eliminar"
                               Appearance="Transparent"
                               Width="30"
                               Height="30"
                               Click="DeleteRow_Click"
                               Tag="{Binding}"/>
                  </StackPanel>
                </DataTemplate>
              </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
          </DataGrid.Columns>
        </DataGrid>

        <!-- Summary -->
        <Grid Grid.Row="2"
            Margin="0,12,0,0">
          <TextBlock>
                        <Run Text="Seleccionadas para importar: "/>
                        <Run x:Name="SelectedCountRun"
                             Text="0"
                             FontWeight="Bold"/>
                        <Run Text=" de "/>
                        <Run x:Name="TotalCountRun"
                             Text="0"
                             FontWeight="Bold"/>
          </TextBlock>
        </Grid>
      </Grid>
    </ui:Card>

    <!-- Progress -->
    <ui:Card Grid.Row="3"
             x:Name="ImportProgressCard"
             Visibility="Collapsed"
             Margin="0,8,0,8"
             Padding="16">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*"/>
          <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel Grid.Column="0">
          <TextBlock x:Name="ImportProgressText"
                     Text="Importando audiencias..."
                     Margin="0,0,0,8"/>
          <ProgressBar x:Name="ImportProgressBar"
                       Height="4"/>
        </StackPanel>

        <TextBlock Grid.Column="1"
                   x:Name="ImportProgressPercent"
                   VerticalAlignment="Center"
                   Margin="16,0,0,0"/>
      </Grid>
    </ui:Card>

    <!-- Action Buttons -->
    <StackPanel Grid.Row="4"
                Orientation="Horizontal"
                HorizontalAlignment="Right">
      <ui:Button x:Name="ImportButton"
                 Content="Importar Seleccionadas"
                 Icon="{ui:SymbolIcon ArrowImport24}"
                 Appearance="Success"
                 IsEnabled="False"
                 Click="Import_Click"
                 Margin="0,0,8,0"
                 Padding="12,8"/>

      <ui:Button Content="Cancelar"
                 IsCancel="True"
                 Click="Cancel_Click"
                 Padding="12,8"/>
    </StackPanel>
  </Grid>
</ui:FluentWindow>
